---
title: "EDA"
author: "Christina De Cesaris"
date: "2/24/2021"
output: html_document
---
```{r}
#test
library(ggplot2)
library(dplyr)
library(plotly)
library(hrbrthemes)
library(gridExtra)
source(file="mergeDatasets.R")
```

```{r}
merged
```


```{r}

#make sure date is of class Date
covid$date=as.Date(covid$date)

#we need a specific californoia dataset to calculate seven day running average
cases_sum=aggregate(covid$newcountconfirmed, by=list(covid$date), sum)
deaths_sum=aggregate(covid$newcountdeaths, by=list(covid$date), sum)
#cut date off to avoid NA error
names(cases_sum)=c('date','total_n_cases')
names(deaths_sum)=c('date','total_n_deaths')
#cases_sum=subset(cases_sum, date >= as.Date("2020-03-01") )
```

```{r}
cases_sum$avg_new_cases=stats::filter(cases_sum$total_n_cases, filter = rep(1/7, 7), sides = 1)


deaths_sum$avg_new_deaths=stats::filter(deaths_sum$total_n_deaths, filter = rep(1/7, 7), sides = 1)


```


```{r 7-Day Average plot, California Cases}

Cali_Cases <- cases_sum %>%
  ggplot( aes(x=date, y=total_n_cases)) +
    geom_area(fill="lightpink", alpha=0.5) +
    geom_line(aes(x=date, y=avg_new_cases,color='7-Day Running Average')) +
    labs(x="Date", y="New Cases",title = "Covid Cases in California", color = "Legend") +
    theme_ipsum()

# Turn it interactive with ggplotly
Cali_Cases <- ggplotly(Cali_Cases)



Cali_Deaths <- deaths_sum %>%
  ggplot( aes(x=date, y=total_n_deaths)) +
    geom_area(fill="lightpink", alpha=0.5) +
    geom_line(aes(x=date, y=avg_new_deaths,color='7-Day Running Average')) +
    labs(x="Date", y="New Deaths",title = "Covid Deaths in California", color = "Legend") +
    theme_ipsum()

# Turn it interactive with ggplotly
Cali_Deaths <- ggplotly(Cali_Deaths)

Cali_Cases
Cali_Deaths
```

```{r Similar Country Size and Density Cases}
who_covid <- read_csv("https://covid19.who.int/WHO-COVID-19-global-data.csv")

iraq_area <- who_covid[who_covid$Country == "Iraq",]  # Iraq has ver close area with CA
spain_density <- who_covid[who_covid$Country == "Spain",]  # Spain has very close population density with CA
```
